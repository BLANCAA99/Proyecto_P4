@model WebApiProyectoFinal.Controllers.LoginViewModel
<main>
    <section class="container">

        <div class="row justify-content-center mt-5">
            <div class="col-md-4">
                <div class="card shadow p-3 mb-5 bg-body rounded">
                    <div class="card-body">
                        <h2 class="card-title text-center">Iniciar sesión</h2>
                        <img src="~/Recursos/user.png" height="180" class="card-img-top" alt="Imagen de inicio de sesión">
                        <form id="loginForm">
                            <div class="form-group">
                                <label for="username">Usuario:</label>
                                <input name="username" type="text" class="form-control" id="username" placeholder="Ingrese su codigo usuario">
                            </div>
                            <div class="form-group mt-3">
                                <label for="password">Contraseña:</label>
                                <input name="password" type="password" class="form-control" id="password" placeholder="Ingrese su contraseña">
                            </div>
                            <div class="form-group mt-3">
                                <label for="selectcentro">Centro de asistencia:</label>
                                <select class="form-control" id="selectcentro" name="selectcentro" style="cursor:pointer;">
                                    <option value="">Selecciona una opción</option>
                                    @foreach (var centro in Model.centrosAsistencia)
                                    {
                                        <option value="@centro.Id_Asistencia">@centro.Descripcion</option>
                                    }
          
                                    <!-- Puedes agregar más opciones según sea necesario -->
                                </select>
                            </div>
                            <div class="row mt-4 mb-3 ">
                                <button type="submit" class="btn btn-primary btn-block ">Iniciar sesión</button>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>

    </section>
</main>



<script type="text/javascript">
    document.getElementById("loginForm").addEventListener("submit", function (event) {
        event.preventDefault();

        var username = document.getElementById("username").value;
        var password = document.getElementById("password").value;
        var centro = document.getElementById("selectcentro").value;

        fetch("/api/login", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ username: username, password: password, centroasistencia: centro })
        })
            .then(response => response.json())
            .then(data => {
                console.log("data", data);
                if (data.success) {


                    // El inicio de sesión fue exitoso, redirige o realiza otras acciones necesarias.
                    window.location.href = "/Home/index";
                } else {
                    // El inicio de sesión falló, muestra un mensaje de error.
                    //document.getElementById("message").textContent = "Credenciales incorrectas. Inténtalo de nuevo.";
                }
            })
            .catch(error => {
                console.error("Error de red:", error);
            });
    });

</script>